{% extends 'base_gradient.html' %}
{% load i18n %}{% load humanize %}
{% block content %}
    <section class="formContent">
        <section>
            <div class="container MainTitle">
                <h3>{{ lesson.subject.course.title }}</h3>
            </div>
        </section>
        <div class="container">
            <div class="accordion" id="AccordionCurso">
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <a class="accordion-toggle" data-toggle="collapse" data-parent="#AccordionCurso" href="#collapseOne">
                            {% trans 'Subject' %} {{  lesson.subject.order }} - {{ lesson.subject.title }}
                        </a>
                        <div  class="arrowAccordion"  data-toggle="collapse" data-parent="#AccordionCurso" href="#collapseOne"></div>
                    </div>
                    <div id="collapseOne" class="accordion-body collapse in">
                        <div class="accordion-inner">
                            <h3>{% trans 'Lesson' %} {{  lesson.order }} - {{ lesson.title }}</h3>
                            {% if lesson.video.converted_video_file_mp4 %}
                                <video id="video_course" class="video-js vjs-default-skin" controls preload="auto" width="100%" height="auto" data-setup="{}">
                                    <source type='video/mp4' src="{{ lesson.video.converted_video_file_mp4.url }}">
                                    <source type='video/webm' src="{{ lesson.video.converted_video_file_webm.url }}">
                                </video>
                            {% endif %}
                            {% if lesson.attach %}
                                <p>{% trans 'Extra Content' %}: <a href="{{ lesson.attach.file.url }}">{% trans 'File' %}</a></p>
                            {% endif %}
                            {% load elearning_extras %}
                            {% if not lesson|user_had_vote_lesson:user.id %}
                                <div id="lesson-{{ lesson.id }}"  data-rating="{{ lesson.get_scoring }}" class="star leftSide"></div>
                            {% else %}
                                <div id="lesson-{{ lesson.id }}"  data-rating="{{ lesson.get_scoring }}" class="star-rated leftSide"></div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="centeredbutton">
        <a class="btn btn-large" href="{% url building_course lesson.subject.course_id %}">{% trans "Back to Builder" %}</a>
    </section>
{% endblock %}
{% block footerscripts %}
    {{ block.super }}
    <script type="text/javascript">
        $('.star').raty({
            readOnly: true,
            half: false,
            score: function() {
                return $(this).attr('data-rating');
            },
            size: 24,
            starHalf  : 'star-half-big.png',
            starOff   : 'star-off-big.png',
            starOn    : 'star-on-big.png',
            click: function(score, evt) {
                window.location.href = "{% url vote_lesson lesson.id %}" + score;
            }
        });
        $('.star-rated').raty({
            readOnly: true,
            half: true,
            size : 24,
            starHalf  : 'star-half-big.png',
            starOff   : 'star-off-big.png',
            starOn    : 'star-on-big.png',
            score: function() {
                return $(this).attr('data-rating');
            },
            click: function(score, evt) {
                window.location.href = "{% url vote_lesson lesson.id %}" + score;
            }
        });
    </script>
{% endblock footerscripts %}