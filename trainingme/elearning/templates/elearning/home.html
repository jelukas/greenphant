{% extends 'base.html' %}
{% load url from future %}{% load thumbnail %}{% load i18n %}
{% block sections %}
    {% if not user.is_authenticated %}
        <section class="bodyGradient new-gradient">
            <div class="row-fluid mainSplash">
                <div class="span12 center">
                    <div id="slider-home" class="carousel slide" data-interval="2500">
                        <!-- Carousel items -->
                        <div class="carousel-inner">
                            <div class="active item"><a href="/pages/enjoy-learning/"><img src="{{ STATIC_URL }}img/slider/slider1.png"></a></div>
                            <div class="item"><a href="/pages/enjoy-teaching/"><img src="{{ STATIC_URL }}img/slider/slider2.png"></a></div>
                            <div class="item"><a href="/pages/enjoy-helping/"><img src="{{ STATIC_URL }}img/slider/slider3.png"></a></div>
                        </div>
                        <!-- Carousel nav -->
                        <a class="carousel-control left" href="#slider-home" data-slide="prev">&lsaquo;</a>
                        <a class="carousel-control right" href="#slider-home" data-slide="next">&rsaquo;</a>
                    </div>
                </div>
            </div>
        </section>
    {% endif %}
    <section class="cursosResultado">
        <div class="container">
            <div class="row-fluid searchBar">
                <div class="span12 center">
                    <!-- linea divisora -->
                    <h3>Estamos en fase BETA sólo para profesores. ¡Regístrate y crea tus cursos!</h3>
                    <hr/>
                    <form class="form-search" method="post" action="">{% csrf_token %}
                        <div class="input-append">
                            <input name="query" type="text"class="span12" id="appendedInputButtons" placeholder="{% trans "Search courses...." %}" />
                            <button type="submit" class="btn btn-primary search-button"><i class="icon-search icon-white"></i> {% trans "Search Course" %}</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row-fluid">
                <div class="boxLine">
                    {% for course in courses %}
                        <div class="span3 cursoBox">
                            <a href="{% url "view_course" course.slug %}">
                                {% if course.image %}
                                    {% thumbnail course.image "238x135" as im %}
                                        <div class="boxTitleBG" style="background-image: url({{ im.url }});background-size:100% 100%;"></div>
                                    {% endthumbnail %}
                                {% else %}
                                    <div class="boxTitleBG" style="background-image: url('{{ STATIC_URL }}/img/dafault_image_course.gif');background-size:100% 100%;"></div>
                                {% endif %}
                            </a>
                            <div class="boxTitle" >
                                <a href="{% url "view_course" course.slug %}">{{ course.title }}</a>
                            </div>
                            <div class="boxDescription">
                                <p>
                                    {{ course.short_description|truncatewords:14 }}
                                </p>
                            </div>
                            <div class="boxInfoFooter">
                                <div class="headerTitle">
                                    <div class="leftSide">{% trans "Enrolls" %}</div>
                                    <div class="middleSide">{% trans "Price" %}</div>
                                    <div class="rightSide">{% trans "Points" %}</div>
                                </div>
                                <div class="footerInfo">
                                    <div class="leftSide">{{ course.enrollments.count }}</div>
                                    <div class="middleSide">{{ course.price }} &euro;</div>
                                    <div id="curso-{{ course.id }}"  data-rating="{{ course.get_scoring }}" class="star rightSide"></div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </section>
{% endblock sections %}
{% block footerscripts %}
    {{ block.super }}
    <script type="text/javascript">
        $('.star').raty({
            readOnly: true,
            half: true,
            score: function() {
                return $(this).attr('data-rating');
            }
        });

        $('.carousel').carousel('cycle');
    </script>
{% endblock footerscripts %}